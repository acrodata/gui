import{Ea as S,Fa as A,Ga as j,J as M,Lb as $,M as w,N as h,O as D,Ob as q,Pa as g,Pb as H,Qa as f,Ra as p,Rb as Q,S as O,Sb as G,U as I,V as F,X as x,Y as L,Ya as v,Z as k,Za as C,_a as y,c as _,da as z,f as E,fb as R,g as b,ga as P,la as u,pb as B,qa as V,ra as d,ub as N,wb as U,za as T}from"./chunk-I5MCOHXJ.js";import{a as r,b as m,f as a}from"./chunk-CWTPBX7D.js";var X=["monacoContainer"],Y=["monacoAnchor"];function J(t,s){t&1&&(g(0,"div",5),p(1,"div",6)(2,"div",7),f())}var K=`ng-monaco-editor,ng-monaco-diff-editor{display:block}.ng-monaco-editor-container{height:100%}.ng-monaco-editor-container__monaco-anchor{width:100%;height:100%}.ng-monaco-editor-container__monaco-anchor .monaco-diff-editor,.ng-monaco-editor-container__monaco-anchor .monaco-editor{flex:1}.ng-monaco-editor-container,.ng-monaco-editor-container__monaco-anchor{flex:1;display:flex;flex-flow:column}.ng-monaco-editor-spinner{width:40px;height:40px;position:absolute;top:50%;left:50%}.ng-monaco-editor-spinner__double-bounce1,.ng-monaco-editor-spinner__double-bounce2{width:100%;height:100%;border-radius:50%;background-color:#333;opacity:.6;position:absolute;top:0;left:0;animation:sk-bounce 2s infinite ease-in-out}.ng-monaco-editor-spinner__double-bounce2{animation-delay:-1s}@keyframes sk-bounce{0%,to{transform:scale(0)}50%{transform:scale(1)}}
`,l=(()=>{class t{baseUrl;dynamicImport;defaultOptions;autoLayoutInterval;static \u0275fac=function(o){return new(o||t)};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),c=(()=>{class t{monacoEditorConfig;_theme;_monaco;_loadingPromise;theme$$=new b(this.theme);theme$=this.theme$$.asObservable();get themes(){return["vs","vs-dark"]}get theme(){return this._theme}get monaco(){return this._monaco||window.monaco}get require(){return window.require}constructor(e){this.monacoEditorConfig=e,this._theme=this.monacoEditorConfig.defaultOptions?.theme??this.themes[0]}initMonaco(){return a(this,null,function*(){return this._loadingPromise||(this._loadingPromise=this.loadMonaco())})}loadModule(e){return new Promise(o=>this.require(e,o))}toggleTheme(){this.changeTheme(this.themes.find(e=>e!==this.theme))}changeTheme(e){this.assertMonaco(),this._theme=e,this.monaco.editor.setTheme(e),this.theme$$.next(this.theme)}getEditorOptions(e){return r(m(r({},this.monacoEditorConfig.defaultOptions),{theme:this.theme}),e)}create(e,o){return this.assertMonaco(),this.monaco.editor.create(e,this.getEditorOptions(o))}createDiffEditor(e,o){return this.assertMonaco(),this.monaco.editor.createDiffEditor(e,r({renderSideBySide:!1,enableSplitViewResizing:!1},this.getEditorOptions(o)))}colorizeElement(e,o){return this.assertMonaco(),this.monaco.editor.colorizeElement(e,r({theme:this.theme},o))}getLanguageExtensionPoint(e){return this.assertMonaco(),this.monaco.languages.getLanguages().find(({aliases:o,id:i})=>o?.includes(e)||i===e)}configAmdLoader(e){return new Promise((o,i)=>{if(this.monaco&&this.require)return o();let n=document.createElement("script");n.type="text/javascript",n.src=[this.monacoEditorConfig.baseUrl,"vs/loader.js"].filter(W=>!!W).join("/"),n.addEventListener("load",()=>{this.require.config({baseUrl:e,paths:{vs:"vs"}}),o()}),n.addEventListener("error",i),document.body.append(n)})}assertMonaco(){if(!this.monaco)throw new Error("`monaco` has not been initialized, please call `initMonaco()` first")}loadMonaco(){return a(this,null,function*(){if(this.monacoEditorConfig.dynamicImport)return this.monacoEditorConfig.dynamicImport().then(e=>this._monaco=e);if(this.monacoEditorConfig.baseUrl!=null)return yield this.configAmdLoader(this.monacoEditorConfig.baseUrl),this.loadModule(["vs/editor/editor.main"]).then(e=>this._monaco=e);if(!window.monaco)throw new Error("No `monaco` found on `window`");return window.monaco})}static \u0275fac=function(o){return new(o||t)(O(l))};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Z=(t,s)=>new _(e=>{let o=new ResizeObserver(i=>{for(let n of i)e.next(n.target)});return o.observe(t,s),()=>{o.unobserve(t),o.disconnect()}}),ee=100,oe=(()=>{class t{monacoEditorConfig;monacoProvider;cdr;options;modelUri;editorChange=new u;editorBlur=new u;modelId;monacoContainer;monacoAnchor;_rootEditor;get rootEditor(){return this._rootEditor??this.editor}set rootEditor(e){this._rootEditor=e}editor;model;_monacoLoaded=!1;get monacoLoaded(){return this._monacoLoaded}_destroyed=!1;get destroyed(){return this._destroyed}destroy$$=new E;get value(){return this._value}_value="";_prevOptions;_disposables=[];constructor(e,o,i){this.monacoEditorConfig=e,this.monacoProvider=o,this.cdr=i}ngOnInit(){this.resetEditor()}ngAfterViewInit(){let e=this.monacoEditorConfig.autoLayoutInterval??ee;e&&Z(this.monacoContainer.nativeElement).pipe(M(this.destroy$$)).subscribe(Q(()=>{this.editor&&this.editor.layout()},e))}ngOnChanges({modelUri:e,options:o}){if(e&&!e.isFirstChange()&&this.resetEditor(),o){let i=o.currentValue;this._prevOptions&&!G(this._prevOptions,i)&&this.rootEditor.updateOptions(i),this._prevOptions=i}}ngOnDestroy(){this.dispose(),this._destroyed=!0}dispose(){this.rootEditor?.dispose(),this.model&&!this.model.isDisposed()&&this.model.dispose(),this._disposables.forEach(e=>e.dispose()),this.rootEditor=this.editor=null,this.model=null,this._disposables=[]}onChange=e=>{};onTouched=()=>{};writeValue(e){this._value=e||"",this.editor&&this.model.setValue(this._value)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}createModel(e,o){let{monaco:i}=this.monacoProvider;return i.editor.createModel(e,this.options.language,o?i.Uri.parse(o):void 0)}resetEditor(){return a(this,null,function*(){this.monacoLoaded?this.dispose():(yield this.monacoProvider.initMonaco(),this._monacoLoaded=!0),this.destroyed||(this.editor=this.createEditor(),this.listenModelChanges(),this.editorChange.emit(this.editor),this.modelId=this.model.id,this.cdr.markForCheck())})}listenModelChanges(){let e=this.editor,o=this.model;this._disposables=[o.onDidChangeContent(()=>{let i=o.getValue();this._value!==i&&(this.onChange(i),this._value=i,this.cdr.markForCheck())}),e.onDidChangeModel(()=>{this.cdr.markForCheck()}),e.onDidBlurEditorWidget(()=>{this.onTouched(),this.editorBlur.emit()})]}static \u0275fac=function(o){return new(o||t)(d(l),d(c),d(B))};static \u0275dir=k({type:t,viewQuery:function(o,i){if(o&1&&(v(X,7),v(Y,7)),o&2){let n;C(n=y())&&(i.monacoContainer=n.first),C(n=y())&&(i.monacoAnchor=n.first)}},hostVars:1,hostBindings:function(o,i){o&2&&A("model-id",i.modelId)},inputs:{options:"options",modelUri:"modelUri"},outputs:{editorChange:"editorChange",editorBlur:"editorBlur"},features:[z]})}return t})();var Me=(()=>{class t extends oe{createEditor(){return this.model=this.createModel(this.value,this.modelUri),this.monacoProvider.create(this.monacoAnchor.nativeElement,m(r({},this.options),{model:this.model}))}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(t)))(i||t)}})();static \u0275cmp=x({type:t,selectors:[["ng-monaco-editor"]],features:[R([{provide:$,useExisting:w(()=>t),multi:!0}]),T],decls:5,vars:1,consts:[["monacoContainer",""],["monacoAnchor",""],[1,"ng-monaco-editor-container"],["class","ng-monaco-editor-spinner",4,"ngIf"],[1,"ng-monaco-editor-container__monaco-anchor"],[1,"ng-monaco-editor-spinner"],[1,"ng-monaco-editor-spinner__double-bounce1"],[1,"ng-monaco-editor-spinner__double-bounce2"]],template:function(o,i){o&1&&(g(0,"div",2,0),S(2,J,3,0,"div",3),p(3,"div",4,1),f()),o&2&&(V(2),j("ngIf",!i.monacoLoaded))},dependencies:[N],styles:[K],encapsulation:2,changeDetection:0})}return t})();function te(t,s){return t||new c(s)}var ie={provide:c,deps:[[new I,new F,c],l],useFactory:te},we=(()=>{class t{static forRoot(e={}){return{ngModule:t,providers:[{provide:l,useValue:e}]}}static \u0275fac=function(o){return new(o||t)};static \u0275mod=L({type:t});static \u0275inj=D({providers:[ie],imports:[U,q,H]})}return t})();export{Me as a,we as b};
